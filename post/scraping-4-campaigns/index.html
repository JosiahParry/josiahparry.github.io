<!DOCTYPE html>

<html lang="en-us">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Josiah Parry</title>
    
    
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="/css/main.min.d3bf53b36f3c9a16e5cdae3b1e9f6320cf7e1833357c47d8a780ef4d7069c3bc.css"/>

    
    
    

    
    
 
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WZD2QXY3QW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WZD2QXY3QW');
</script>
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="/">Josiah Parry</a>
    </div>
      
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/atelier-estuary-light.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<a rel="me" href="https://fosstodon.org/@josiahparry"></a>
<a rel="me" href="https://mapstodon.space/@josiah"></a>

</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="/about/">about</a>
  
    <a class="color-link nav-link" href="/">posts</a>
  
    <a class="color-link nav-link" href="/projects/">projects</a>
  
    <a class="color-link nav-link" href="/tags/">tags</a>
  
    <a class="color-link nav-link" href="/archives/">archives</a>
  
  <a class="color-link nav-link" href="/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    
    <a class="social-icon" href="https://twitter.com/@josiahparry" target="_blank" rel="noopener" title="Twitter">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M8.991284,24.971612 C19.180436,24.971612 24.752372,16.530224 24.752372,9.210524 C24.752372,8.970656 24.747512,8.731868 24.736496,8.494376 C25.818008,7.712564 26.758256,6.737 27.5,5.62622 C26.507372,6.067076 25.439252,6.364292 24.318752,6.498212 C25.462472,5.812628 26.340512,4.727444 26.754584,3.434036 C25.684088,4.068536 24.499004,4.53002 23.23724,4.778528 C22.226468,3.701876 20.786828,3.028388 19.193828,3.028388 C16.134404,3.028388 13.653536,5.509256 13.653536,8.567492 C13.653536,9.0023 13.702244,9.424904 13.797176,9.830552 C9.19346,9.599108 5.11106,7.39472 2.3792,4.04294 C1.903028,4.861364 1.629032,5.812628 1.629032,6.827072 C1.629032,8.74904 2.606972,10.445612 4.094024,11.438132 C3.185528,11.41016 2.331788,11.160464 1.585184,10.745096 C1.583888,10.768208 1.583888,10.791428 1.583888,10.815728 C1.583888,13.49888 3.493652,15.738584 6.028088,16.246508 C5.562932,16.373084 5.07326,16.44134 4.56782,16.44134 C4.210988,16.44134 3.863876,16.406024 3.526484,16.34144 C4.231724,18.542264 6.276596,20.143796 8.701412,20.18894 C6.805148,21.674696 4.416836,22.56008 1.821488,22.56008 C1.374476,22.56008 0.93362,22.534592 0.5,22.4834 C2.951708,24.054476 5.862524,24.971612 8.991284,24.971612"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://linkedin.com/in/josiahparry" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    
    <a class="social-icon" href="https://medium.com/@JosiahParry/" target="_blank" rel="noopener" title="Medium">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,2 L26,2 L26,26 L2,26 L2,2 Z M7.72727142,10.0265545 L7.72727142,17.1527156 C7.77112416,17.4097828 7.69008764,17.6723786 7.50898513,17.8600642 L5.81538462,19.9143852 L5.81538462,20.1852847 L10.617683,20.1852847 L10.617683,19.9143852 L8.92408245,17.8600642 C8.74165168,17.6726892 8.65559727,17.4118239 8.69074193,17.1527156 L8.69074193,10.9897526 L12.9059255,20.1852847 L13.3951878,20.1852847 L17.0157294,10.9897526 L17.0157294,18.3190884 C17.0157294,18.514738 17.0157294,18.5523628 16.8877685,18.6802876 L15.5855778,19.9444852 L15.5855778,20.2153846 L21.9083531,20.2153846 L21.9083531,19.9444852 L20.6513252,18.7103876 C20.5403599,18.6258033 20.4853154,18.4867833 20.50831,18.3491883 L20.50831,9.28158097 C20.4853154,9.14398599 20.5403599,9.00496587 20.6513252,8.92038167 L21.9384615,7.68628409 L21.9384615,7.41538462 L17.4824105,7.41538462 L14.3059685,15.3391941 L10.6929541,7.41538462 L6.01861668,7.41538462 L6.01861668,7.68628409 L7.52403936,9.49980554 C7.67182769,9.63301305 7.74730311,9.82863473 7.72727142,10.0265545 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/josiahparry" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    
</div>




 
	
	<script src="/js/main.min.c1aee25a817e9beb1f9c4afd9d62311227a7f5e46720e404dc1dda97281f47f2.js" integrity="sha256-wa7iWoF+m+sfnEr9nWIxEien9eRnIOQE3B3alygfR/I="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        

<h1 class="post-title">Web-scraping for Campaigns</h1>
    
    <time>June 11, 2019</time>
    
    <div>
        <p>
        


<p>As the primaries approach, I am experiencing a mix of angst, FOMO, and excitement. One of my largest concerns is that progressive campaigns are stuck in a sort of antiquated but nonetheless entrenched workflow. Google Sheets reign in metric reporting. Here I want to present one use case (of a few more to come) where R can be leveraged by your data team.</p>
<p>In this post I show you how to scrape the most recent polling data from FiveThirtyEight. FiveThirtyEight aggregates this data in an available way. This can allow you as a Data Manager to provide a useful report to your Media Manager.</p>
<p>As always, please feel free to contact me on Twitter <a href="https://twitter.com/josiahparry">@josiahparry</a> if you have any questions or want to discuss this further.</p>
<hr />
<div id="polling-use-case" class="section level1">
<h1>Polling use case</h1>
<p>A very important metric to keep track of is how your candidate is polling. Are they gaining a lead in the polls or falling behind? This data is often reported via traditional news organizations or some other mediums. The supposed demi-God and mythical pollster Nate Silver’s organization FiveThirtyEight does a wonderful job aggregating polls. Their page <a href="https://projects.fivethirtyeight.com/2020-primaries/democratic/national/">National 2020 Democratic Presidential Primary Polls</a> has a table of the most recent polls from many different pollsters.</p>
<p>In this use case we will acquire this data by web scraping using <code>rvest</code>. We will also go over ways to programatically save polls results to a text file. Saving polling results can allow you present a long term view of your candidate’s growth during the quarter.</p>
<div id="understanding-rvest" class="section level2">
<h2>Understanding <code>rvest</code></h2>
<p>This use case will provide a cursory overview of the package <code>rvest</code>. To learn more go <a href="http://rvest.tidyverse.org/">here</a>.</p>
<p>Web scraping is the process of extracting data from a website. Websites are written in HTML and CSS. There are a few aspects of these languages that are used in web scraping that is important to know. HTML is written in a series of what are call tags. A tag is a set of characters wrapped in angle brackets—i.e. <code>&lt;img&gt;</code>.</p>
<p>With CSS (cascading style sheets), web developers can give unique identifiers to a tag. Classes can also be assigned to a tag. Think of these as group. With web scraping we can specify a particular part of a website by it’s HTML tag and perhaps it’s class or ID. <code>rvest</code> provides a large set of functions to make this simpler.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>For this example we will be scraping FiveThirtyEight’s aggregated poll table. The table can be found at <a href="https://projects.fivethirtyeight.com/2020-primaries/democratic/national/" class="uri">https://projects.fivethirtyeight.com/2020-primaries/democratic/national/</a>.</p>
<p>Before we begin, we must always prepare our workspace. Mise en place.</p>
<pre class="r"><code>library(rvest)</code></pre>
<pre><code>## Loading required package: xml2</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──────────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0          ✔ purrr   0.3.0.9000
## ✔ tibble  2.1.1          ✔ dplyr   0.7.8     
## ✔ tidyr   0.8.2          ✔ stringr 1.4.0     
## ✔ readr   1.2.1          ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ─────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter()         masks stats::filter()
## ✖ readr::guess_encoding() masks rvest::guess_encoding()
## ✖ dplyr::lag()            masks stats::lag()
## ✖ purrr::pluck()          masks rvest::pluck()</code></pre>
<p>The first thing we will have to do is specify what page we will be scraping from. <code>html_session()</code> will simulate a session in an html browser. By providing a URL to <code>html_session()</code> we will then be able to access the underlying code of that page. Create an object called <code>session</code> by providing the FiveThirtyEight URL to <code>html_session()</code>.</p>
<pre class="r"><code>session &lt;- html_session(&quot;https://projects.fivethirtyeight.com/2020-primaries/democratic/national/&quot;)</code></pre>
<p>The next and most important step is to identify which piece of HTML code contains the table. The easiest way to do this is to open up the webpage in Chrome and open up the Inspect Elements view (on Mac - ⌘ + Shift + C). Now that this is open, click the select element button at the top left corner of the inspection pane. Now hover over the table.</p>
<p>You will see that the HTML element is highlighted. We can see that it is a <code>table</code> tag. Additionally we see that there are two different classes <code>polls-table</code> and <code>tracker</code>. To specify a class we put a preceding <code>.</code> to the class name—i.e. <code>.class-name</code>. If there are multiple classes we just append the second class name to it—i.e. <code>.first-class.second-class</code>. Be aware that these selectors can be quite finicky and be a bit difficult to figure out. You might need to do some googling or playing around with the selector.</p>
<p>To actually access the content of this HTML element, we must specify the element using the proper selector. <code>html_node()</code> will be used to do this. Provide the html session and the CSS selector to <code>html_node()</code> to extract the HTML element.</p>
<pre class="r"><code>session %&gt;% 
  html_node(&quot;.polls-table.tracker&quot;)</code></pre>
<pre><code>## {xml_node}
## &lt;table class=&quot;polls-table tracker&quot;&gt;
## [1] &lt;thead class=&quot;hide-mobile&quot; id=&quot;table-header&quot;&gt;&lt;tr&gt;\n&lt;th class=&quot;new&quot;&gt;&lt; ...
## [2] &lt;tbody&gt;\n&lt;tr class=&quot;visible-row&quot; data-id=&quot;97723&quot;&gt;\n&lt;!-- Shared--&gt;&lt;td ...</code></pre>
<p>Here we see that this returns on object of class <code>xml_node</code>. This object returns some HTML code but it is still not entirely workable. Since this is an HTML table we want to extract we can use the handy <code>html_table()</code>. Note that if this wasn’t a table but rather text, you can use <code>html_text()</code>.</p>
<pre class="r"><code>session %&gt;% 
  html_node(&quot;.polls-table.tracker&quot;) %&gt;% 
  html_table()</code></pre>
<p>Take note of the extremely informative error. It appears we might have to deal with mismatching columns.</p>
<pre class="r"><code>session %&gt;% 
  html_node(&quot;.polls-table.tracker&quot;) %&gt;% 
  html_table(fill = TRUE) %&gt;% 
  head()</code></pre>
<pre><code>##                          Dates           Pollster                  Sample
## 1 •       Jun 6-10, 2019503 RV     Jun 6-10, 2019 A-Quinnipiac University
## 2 •     Jun 3-9, 201917,012 LV      Jun 3-9, 2019       B-Morning Consult
## 3 • May 29-Jun 5, 20192,271 RV May 29-Jun 5, 2019                 B+Ipsos
## 4 •  May 29-Jun 5, 20192,525 A May 29-Jun 5, 2019                 B+Ipsos
## 5 •        Jun 2-4, 2019500 RV      Jun 2-4, 2019                 BYouGov
## 6 •         Jun 2-4, 2019550 A      Jun 2-4, 2019                 BYouGov
##   Sample Biden Sanders Harris Warren O&#39;Rourke Buttigieg Booker Klobuchar
## 1    503    RV     30%    19%     7%      15%        3%     8%        1%
## 2 17,012    LV     37%    19%     7%      11%        4%     7%        3%
## 3  2,271    RV     31%    14%     6%       9%        3%     5%        2%
## 4  2,525     A     30%    15%     6%       8%        4%     5%        2%
## 5    500    RV     27%    15%     9%      12%        2%    10%        2%
## 6    550     A     27%    16%     8%      11%        2%     9%        2%
##   Castro Yang Gillibrand Hickenlooper Gabbard Delaney Inslee Ryan Bullock
## 1     1%   0%         1%           0%      0%      0%     0%   0%      1%
## 2     2%   1%         1%           1%      1%      1%     1%   1%      1%
## 3     2%   1%         1%           0%      1%      1%     0%   0%      1%
## 4     1%   0%         1%           0%      1%      1%     0%   0%      1%
## 5     1%   0%         1%           0%      1%      1%     1%   0%      0%
## 6     1%   0%         1%           0%      1%      1%     1%   0%      0%
##   de Blasio Bennet Williamson Gravel Swalwell Moulton Messam H. Clinton
## 1        0%     0%         0%     0%       0%      0%     0%         0%
## 2        1%     0%         1%     0%               0%     0%           
## 3        0%     1%         0%     0%       0%      0%     0%         0%
## 4        0%     1%         0%     0%       0%      0%     0%         0%
## 5        1%     2%         0%     0%       0%      0%     0%         0%
## 6        1%     2%         0%     0%       0%      0%     0%         0%
##   Bloomberg M. Obama Brown Kerry Abrams Holder McAuliffe Winfrey Ojeda
## 1                                                                     
## 2                                                                     
## 3                                                                     
## 4                                                                     
## 5                                                                     
## 6                                                                     
##   Trump Cuomo Avenatti Kennedy Patrick Zuckerberg Pelosi Garcetti Newsom
## 1                                                                       
## 2                                                                       
## 3                                                                       
## 4                                                                       
## 5                                                                       
## 6                                                                       
##   Steyer Schultz Kaine Johnson Kucinich Lee Scott Sinema Warner NA
## 1                                                                 
## 2                                                                 
## 3                                                                 
## 4                                                                 
## 5                                                                 
## 6                                                                 
##                                                                                                                                                                                                                                NA
## 1  Biden30%Sanders19%Warren15%Buttigieg8%Harris7%O&#39;Rourke3%Booker1%Klobuchar1%Yang1%Ryan1%Gillibrand0%Castro0%Gabbard0%Inslee0%Hickenlooper0%Delaney0%Williamson0%Messam0%Swalwell0%Moulton0%Bennet0%Bullock0%de Blasio0%Gravel0%
## 2                  Biden37%Sanders19%Warren11%Buttigieg7%Harris7%O&#39;Rourke4%Booker3%Klobuchar2%Bennet1%Bullock1%Castro1%Delaney1%Gabbard1%Gillibrand1%Hickenlooper1%Inslee1%Yang1%Ryan1%de Blasio0%Moulton0%Swalwell0%Williamson0%
## 3   Biden31%Sanders14%Warren9%Harris6%Buttigieg5%O&#39;Rourke3%Booker2%Klobuchar2%Castro1%Gabbard1%Hickenlooper1%Yang1%Ryan1%de Blasio1%Gillibrand0%Bullock0%Inslee0%Delaney0%Williamson0%Messam0%Swalwell0%Moulton0%Bennet0%Gravel0%
## 4   Biden30%Sanders15%Warren8%Harris6%Buttigieg5%O&#39;Rourke4%Booker2%Klobuchar1%Gabbard1%Hickenlooper1%Yang1%Ryan1%de Blasio1%Castro0%Gillibrand0%Bullock0%Inslee0%Delaney0%Williamson0%Messam0%Swalwell0%Moulton0%Bennet0%Gravel0%
## 5 Biden27%Sanders15%Warren12%Buttigieg10%Harris9%Booker2%de Blasio2%O&#39;Rourke2%Bullock1%Delaney1%Gabbard1%Hickenlooper1%Klobuchar1%Yang1%Bennet0%Castro0%Gillibrand0%Gravel0%Inslee0%Messam0%Moulton0%Ryan0%Swalwell0%Williamson0%
## 6  Biden27%Sanders16%Warren11%Buttigieg9%Harris8%Booker2%de Blasio2%O&#39;Rourke2%Bullock1%Delaney1%Gabbard1%Hickenlooper1%Klobuchar1%Yang1%Bennet0%Castro0%Gillibrand0%Gravel0%Inslee0%Messam0%Moulton0%Ryan0%Swalwell0%Williamson0%</code></pre>
<p>This is much better! But based on visual inspection the column headers are not properly matched. There are a few things that need to be sorted out: there are two date columns, there are commas and percents where numeric columns should be, the column headers are a little messy, and the table isn’t a tibble (this is just personal preference).</p>
<p>We will handle the final two issues first as they are easiest to deal with. The function <code>clean_names()</code> from <code>janitor</code> will handle the column headers, and <code>as_tibble()</code> will coerce the data.frame into a proper tibble. Save this semi-clean tibble into an object called <code>polls</code>.</p>
<pre class="r"><code>polls &lt;- session %&gt;% 
  html_node(&quot;.polls-table.tracker&quot;) %&gt;% 
  html_table(fill = TRUE) %&gt;% 
  janitor::clean_names() %&gt;% 
  as_tibble()

polls</code></pre>
<pre><code>## # A tibble: 116 x 59
##    x     dates pollster sample sample_2 biden sanders harris warren
##    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; 
##  1 •     Jun … Jun 6-1… A-Qui… 503      RV    30%     19%    7%    
##  2 •     Jun … Jun 3-9… B-Mor… 17,012   LV    37%     19%    7%    
##  3 •     May … May 29-… B+Ips… 2,271    RV    31%     14%    6%    
##  4 •     May … May 29-… B+Ips… 2,525    A     30%     15%    6%    
##  5 •     Jun … Jun 2-4… BYouG… 500      RV    27%     15%    9%    
##  6 •     Jun … Jun 2-4… BYouG… 550      A     27%     16%    8%    
##  7 •     Jun … Jun 1-2… C+Har… 431      RV    35%     16%    4%    
##  8 •     May … May 27-… B-Mor… 16,587   LV    38%     19%    7%    
##  9 •     May … May 28-… A-CNN… 412      RV    32%     18%    8%    
## 10 •     May … May 29-… C+Har… 471      RV    36%     17%    8%    
## # … with 106 more rows, and 50 more variables: o_rourke &lt;chr&gt;,
## #   buttigieg &lt;chr&gt;, booker &lt;chr&gt;, klobuchar &lt;chr&gt;, castro &lt;chr&gt;,
## #   yang &lt;chr&gt;, gillibrand &lt;chr&gt;, hickenlooper &lt;chr&gt;, gabbard &lt;chr&gt;,
## #   delaney &lt;chr&gt;, inslee &lt;chr&gt;, ryan &lt;chr&gt;, bullock &lt;chr&gt;,
## #   de_blasio &lt;chr&gt;, bennet &lt;chr&gt;, williamson &lt;chr&gt;, gravel &lt;chr&gt;,
## #   swalwell &lt;chr&gt;, moulton &lt;chr&gt;, messam &lt;chr&gt;, h_clinton &lt;chr&gt;,
## #   bloomberg &lt;chr&gt;, m_obama &lt;chr&gt;, brown &lt;chr&gt;, kerry &lt;chr&gt;,
## #   abrams &lt;chr&gt;, holder &lt;chr&gt;, mc_auliffe &lt;chr&gt;, winfrey &lt;chr&gt;,
## #   ojeda &lt;chr&gt;, trump &lt;chr&gt;, cuomo &lt;chr&gt;, avenatti &lt;chr&gt;, kennedy &lt;chr&gt;,
## #   patrick &lt;chr&gt;, zuckerberg &lt;chr&gt;, pelosi &lt;chr&gt;, garcetti &lt;chr&gt;,
## #   newsom &lt;chr&gt;, steyer &lt;chr&gt;, schultz &lt;chr&gt;, kaine &lt;chr&gt;, johnson &lt;chr&gt;,
## #   kucinich &lt;chr&gt;, lee &lt;chr&gt;, scott &lt;chr&gt;, sinema &lt;chr&gt;, warner &lt;chr&gt;,
## #   na &lt;chr&gt;, na_2 &lt;chr&gt;</code></pre>
<p>We want to shift over the column names to the right just once. Unfortunately there is no elegant way to do this (that I am aware of). We can see that the first column is completely useless so that can be removed. Once that column is removed we can reset the names this way they will be well aligned.</p>
<p>We will start by creating a vector of the original column names.</p>
<pre class="r"><code>col_names &lt;- names(polls)
col_names</code></pre>
<pre><code>##  [1] &quot;x&quot;            &quot;dates&quot;        &quot;pollster&quot;     &quot;sample&quot;      
##  [5] &quot;sample_2&quot;     &quot;biden&quot;        &quot;sanders&quot;      &quot;harris&quot;      
##  [9] &quot;warren&quot;       &quot;o_rourke&quot;     &quot;buttigieg&quot;    &quot;booker&quot;      
## [13] &quot;klobuchar&quot;    &quot;castro&quot;       &quot;yang&quot;         &quot;gillibrand&quot;  
## [17] &quot;hickenlooper&quot; &quot;gabbard&quot;      &quot;delaney&quot;      &quot;inslee&quot;      
## [21] &quot;ryan&quot;         &quot;bullock&quot;      &quot;de_blasio&quot;    &quot;bennet&quot;      
## [25] &quot;williamson&quot;   &quot;gravel&quot;       &quot;swalwell&quot;     &quot;moulton&quot;     
## [29] &quot;messam&quot;       &quot;h_clinton&quot;    &quot;bloomberg&quot;    &quot;m_obama&quot;     
## [33] &quot;brown&quot;        &quot;kerry&quot;        &quot;abrams&quot;       &quot;holder&quot;      
## [37] &quot;mc_auliffe&quot;   &quot;winfrey&quot;      &quot;ojeda&quot;        &quot;trump&quot;       
## [41] &quot;cuomo&quot;        &quot;avenatti&quot;     &quot;kennedy&quot;      &quot;patrick&quot;     
## [45] &quot;zuckerberg&quot;   &quot;pelosi&quot;       &quot;garcetti&quot;     &quot;newsom&quot;      
## [49] &quot;steyer&quot;       &quot;schultz&quot;      &quot;kaine&quot;        &quot;johnson&quot;     
## [53] &quot;kucinich&quot;     &quot;lee&quot;          &quot;scott&quot;        &quot;sinema&quot;      
## [57] &quot;warner&quot;       &quot;na&quot;           &quot;na_2&quot;</code></pre>
<p>Unfortunately this also presents another issue. Once a column is deselected, there will be one more column name than column. So we will need to select all but the last element of the original names. We will create a vector called <code>new_names</code>.</p>
<pre class="r"><code># identify the integer number of the last column
last_col &lt;- length(col_names) - 1

# create a vector which will be used for the new names
new_names &lt;- col_names[1:last_col]</code></pre>
<p>Now we can try implementing the hacky solution. Here we will deselect the first column and reset the names using <code>setNames()</code>. Following, we will use the <a href="https://dplyr.tidyverse.org/reference/mutate_all.html"><code>mutate_at()</code></a> variant to remove the percent sign from every candidate column and coerce them into integer columns. Here we will specify which variables to <em>not</em> mutate at within <code>vars()</code>.</p>
<pre class="r"><code>polls %&gt;% 
  select(-1) %&gt;%  
  setNames(new_names)%&gt;%
  select(-1) %&gt;%
  mutate_at(vars(-c(&quot;dates&quot;, &quot;pollster&quot;, &quot;sample&quot;, &quot;sample_2&quot;)), 
            ~as.integer(str_remove(., &quot;%&quot;)))</code></pre>
<pre><code>## Warning in (structure(function (..., .x = ..1, .y = ..2, . = ..1) : NAs
## introduced by coercion</code></pre>
<pre><code>## # A tibble: 116 x 57
##    dates pollster sample sample_2 biden sanders harris warren o_rourke
##    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    &lt;int&gt;   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;    &lt;int&gt;
##  1 Jun … A-Quinn… 503    RV          30      19      7     15        3
##  2 Jun … B-Morni… 17,012 LV          37      19      7     11        4
##  3 May … B+Ipsos  2,271  RV          31      14      6      9        3
##  4 May … B+Ipsos  2,525  A           30      15      6      8        4
##  5 Jun … BYouGov  500    RV          27      15      9     12        2
##  6 Jun … BYouGov  550    A           27      16      8     11        2
##  7 Jun … C+Harri… 431    RV          35      16      4      5        4
##  8 May … B-Morni… 16,587 LV          38      19      7     10        4
##  9 May … A-CNN/S… 412    RV          32      18      8      7        5
## 10 May … C+Harri… 471    RV          36      17      8      5        4
## # … with 106 more rows, and 48 more variables: buttigieg &lt;int&gt;,
## #   booker &lt;int&gt;, klobuchar &lt;int&gt;, castro &lt;int&gt;, yang &lt;int&gt;,
## #   gillibrand &lt;int&gt;, hickenlooper &lt;int&gt;, gabbard &lt;int&gt;, delaney &lt;int&gt;,
## #   inslee &lt;int&gt;, ryan &lt;int&gt;, bullock &lt;int&gt;, de_blasio &lt;int&gt;,
## #   bennet &lt;int&gt;, williamson &lt;int&gt;, gravel &lt;int&gt;, swalwell &lt;int&gt;,
## #   moulton &lt;int&gt;, messam &lt;int&gt;, h_clinton &lt;int&gt;, bloomberg &lt;int&gt;,
## #   m_obama &lt;int&gt;, brown &lt;int&gt;, kerry &lt;int&gt;, abrams &lt;int&gt;, holder &lt;int&gt;,
## #   mc_auliffe &lt;int&gt;, winfrey &lt;int&gt;, ojeda &lt;int&gt;, trump &lt;int&gt;,
## #   cuomo &lt;int&gt;, avenatti &lt;int&gt;, kennedy &lt;int&gt;, patrick &lt;int&gt;,
## #   zuckerberg &lt;int&gt;, pelosi &lt;int&gt;, garcetti &lt;int&gt;, newsom &lt;int&gt;,
## #   steyer &lt;int&gt;, schultz &lt;int&gt;, kaine &lt;int&gt;, johnson &lt;int&gt;,
## #   kucinich &lt;int&gt;, lee &lt;int&gt;, scott &lt;int&gt;, sinema &lt;int&gt;, warner &lt;int&gt;,
## #   na &lt;int&gt;</code></pre>
<p>Now we must tidy the data. We will use <code>tidyr::gather()</code> to transform the data from wide to long. In short, gather takes the column headers (the <code>key</code> argument) and creates a new variable from the values of the columns (the <code>value</code> argument). In this case, we will create a new column called <code>candidate</code> from the column headers and a second column called <code>points</code> which are a candidates polling percentage. Next we deselect any columns that we do not want to be gathered.</p>
<pre class="r"><code>polls %&gt;% 
  select(-1) %&gt;% 
  setNames(new_names)%&gt;%
  select(-1) %&gt;%
  mutate_at(vars(-c(&quot;dates&quot;, &quot;pollster&quot;, &quot;sample&quot;, &quot;sample_2&quot;)),
            ~as.integer(str_remove(., &quot;%&quot;))) %&gt;% 
  gather(candidate, points, -dates, -pollster, -sample, -sample_2)</code></pre>
<pre><code>## Warning in (structure(function (..., .x = ..1, .y = ..2, . = ..1) : NAs
## introduced by coercion</code></pre>
<pre><code>## # A tibble: 6,148 x 6
##    dates             pollster              sample sample_2 candidate points
##    &lt;chr&gt;             &lt;chr&gt;                 &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;      &lt;int&gt;
##  1 Jun 6-10, 2019    A-Quinnipiac Univers… 503    RV       biden         30
##  2 Jun 3-9, 2019     B-Morning Consult     17,012 LV       biden         37
##  3 May 29-Jun 5, 20… B+Ipsos               2,271  RV       biden         31
##  4 May 29-Jun 5, 20… B+Ipsos               2,525  A        biden         30
##  5 Jun 2-4, 2019     BYouGov               500    RV       biden         27
##  6 Jun 2-4, 2019     BYouGov               550    A        biden         27
##  7 Jun 1-2, 2019     C+HarrisX             431    RV       biden         35
##  8 May 27-Jun 2, 20… B-Morning Consult     16,587 LV       biden         38
##  9 May 28-31, 2019   A-CNN/SSRS            412    RV       biden         32
## 10 May 29-30, 2019   C+Harris Interactive  471    RV       biden         36
## # … with 6,138 more rows</code></pre>
<p>There are a few more house-keeping things that need to be done to improve this data set. <code>sample_2</code> is rather uninformative. On the FiveThirtyEight website there is a key which describes what these values represent (<code>A = ADULTS, RV = REGISTERED VOTERS, V = VOTERS, LV = LIKELY VOTERS</code>). This should be specified in our data set. In addition the <code>sample</code> column ought to be cast into an integer column. And finally, those messy dates will need to be cleaned. My approach to this requires creating a function to handle this cleaning. First, the simple stuff.</p>
<p>To do the first two above steps, we will continue our function chain and save it to a new variable <code>polls_tidy</code>.</p>
<pre class="r"><code>polls_tidy &lt;- polls %&gt;% 
  select(-1) %&gt;% 
  setNames(new_names)%&gt;%
  select(-1) %&gt;%
  mutate_at(vars(-c(&quot;dates&quot;, &quot;pollster&quot;, &quot;sample&quot;, &quot;sample_2&quot;)), 
            ~as.integer(str_remove(., &quot;%&quot;))) %&gt;% 
  gather(candidate, points, -dates, -pollster, -sample, -sample_2) %&gt;% 
  mutate(sample_2 = case_when(
    sample_2 == &quot;RV&quot; ~ &quot;Registered Voters&quot;,
    sample_2 == &quot;LV&quot; ~ &quot;Likely Voters&quot;,
    sample_2 == &quot;A&quot; ~ &quot;Adults&quot;,
    sample_2 == &quot;V&quot; ~ &quot;Voters&quot;
  ),
  sample = as.integer(str_remove(sample, &quot;,&quot;)))</code></pre>
<pre><code>## Warning in (structure(function (..., .x = ..1, .y = ..2, . = ..1) : NAs
## introduced by coercion</code></pre>
<pre class="r"><code>polls_tidy</code></pre>
<pre><code>## # A tibble: 6,148 x 6
##    dates          pollster           sample sample_2       candidate points
##    &lt;chr&gt;          &lt;chr&gt;               &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt;
##  1 Jun 6-10, 2019 A-Quinnipiac Univ…    503 Registered Vo… biden         30
##  2 Jun 3-9, 2019  B-Morning Consult   17012 Likely Voters  biden         37
##  3 May 29-Jun 5,… B+Ipsos              2271 Registered Vo… biden         31
##  4 May 29-Jun 5,… B+Ipsos              2525 Adults         biden         30
##  5 Jun 2-4, 2019  BYouGov               500 Registered Vo… biden         27
##  6 Jun 2-4, 2019  BYouGov               550 Adults         biden         27
##  7 Jun 1-2, 2019  C+HarrisX             431 Registered Vo… biden         35
##  8 May 27-Jun 2,… B-Morning Consult   16587 Likely Voters  biden         38
##  9 May 28-31, 20… A-CNN/SSRS            412 Registered Vo… biden         32
## 10 May 29-30, 20… C+Harris Interact…    471 Registered Vo… biden         36
## # … with 6,138 more rows</code></pre>
<div id="date-cleaning" class="section level3">
<h3>Date cleaning</h3>
<p>Next we must work to clean the date field. I find that when working with a messy column, creating a single function which handles the cleaning is one of the most effective approaches. Here we will create a function which takes a value provided from the <code>dates</code> field and return a cleaned date. There are two unique cases I identified. There are poll dates which occurred during a single month, or a poll that spanned two months. The dates are separated by a single hyphen <code>-</code>. If we split the date at <code>-</code> we will either receive two elements with a month indicated or one month with a day and a day number. In the latter case we will have to carry over the month. Then the year can be appended to it and parsed as a date using the <code>lubridate</code> package. For more on <code>lubridate</code> visit <a href="https://lubridate.tidyverse.org/">here</a>.</p>
<p>The function will only return one date at a time. The two arguments will be <code>date</code> and <code>.return</code> to indicate whether the first or second date should be provided. The internals of this function rely heavily on the <code>stringr</code> package (see R for Data Science <a href="https://r4ds.had.co.nz/strings.html">Chapter 14</a>). <code>switch()</code> at the end of the function determines which date should be returned (see Advanced R <a href="https://adv-r.hadley.nz/control-flow.html">Chapter 5</a>).</p>
<pre class="r"><code>clean_date &lt;- function(date, .return = &quot;first&quot;) {
  # take date and split at the comma to get the year and the month-day combo
  date_split &lt;- str_split(date, &quot;,&quot;) %&gt;% 
    # remove from list / coerce to vector
    unlist() %&gt;% 
    # remove extra white space
    str_trim()
  
  # extract the year
  date_year &lt;- date_split[2]
  
  # split the month day portion and coerce to vector
  dates &lt;- unlist(str_split(date_split[1],  &quot;-&quot;))
  
  # paste the month day and year together then parse as date using `mdy()`
  first_date &lt;- paste(dates[1], date_year) %&gt;% 
    lubridate::mdy()
  
  second_date &lt;- ifelse(!str_detect(dates[2], &quot;[A-z]+&quot;),
                        yes = paste(str_extract(dates[1], &quot;[A-z]+&quot;), 
                              dates[2], 
                              date_year), 
                        no = paste(dates[2], date_year)) %&gt;% 
    lubridate::mdy()
  
  switch(.return, 
         first = return(first_date),
         second = return(second_date)
         )
  
}

# test on a date
clean_date(polls_tidy$dates[10], .return = &quot;first&quot;)</code></pre>
<pre><code>## [1] &quot;2019-05-29&quot;</code></pre>
<pre class="r"><code>clean_date(polls_tidy$dates[10], .return = &quot;second&quot;)</code></pre>
<pre><code>## [1] &quot;2019-05-30&quot;</code></pre>
<p>We can use this new function to create two new columns <code>poll_start</code> and <code>poll_end</code> using <code>mutate()</code>. Following this we can deselect the original <code>dates</code> column, remove any observations missing a <code>points</code> value, remove duplicates using <code>distinct()</code>, and save this to <code>polls_clean</code>.</p>
<pre class="r"><code>polls_clean &lt;- polls_tidy %&gt;% 
  mutate(poll_start = clean_date(dates, &quot;first&quot;),
         poll_end = clean_date(dates, &quot;second&quot;)) %&gt;% 
  select(-dates) %&gt;% 
  filter(!is.na(points)) %&gt;% 
  distinct()

polls_clean</code></pre>
<pre><code>## # A tibble: 1,955 x 7
##    pollster       sample sample_2    candidate points poll_start poll_end  
##    &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;int&gt; &lt;date&gt;     &lt;date&gt;    
##  1 A-Quinnipiac …    503 Registered… biden         30 2019-06-06 2019-06-10
##  2 B-Morning Con…  17012 Likely Vot… biden         37 2019-06-06 2019-06-10
##  3 B+Ipsos          2271 Registered… biden         31 2019-06-06 2019-06-10
##  4 B+Ipsos          2525 Adults      biden         30 2019-06-06 2019-06-10
##  5 BYouGov           500 Registered… biden         27 2019-06-06 2019-06-10
##  6 BYouGov           550 Adults      biden         27 2019-06-06 2019-06-10
##  7 C+HarrisX         431 Registered… biden         35 2019-06-06 2019-06-10
##  8 B-Morning Con…  16587 Likely Vot… biden         38 2019-06-06 2019-06-10
##  9 A-CNN/SSRS        412 Registered… biden         32 2019-06-06 2019-06-10
## 10 C+Harris Inte…    471 Registered… biden         36 2019-06-06 2019-06-10
## # … with 1,945 more rows</code></pre>
</div>
<div id="visualization" class="section level3">
<h3>Visualization</h3>
<p>The cleaned data can be aggregated and visualized.</p>
<pre class="r"><code>avg_polls &lt;- polls_clean %&gt;% 
  group_by(candidate) %&gt;% 
  summarise(avg_points = mean(points, na.rm = TRUE),
            min_points = min(points, na.rm = TRUE),
            max_points = max(points, na.rm = TRUE),
            n_polls = n() - sum(is.na(points))) %&gt;% # identify how many polls candidate is in
  # remove candidates who appear in 50 or fewer polls: i.e. HRC
  filter(n_polls &gt; 50) %&gt;% 
  arrange(-avg_points)

avg_polls</code></pre>
<pre><code>## # A tibble: 16 x 5
##    candidate    avg_points min_points max_points n_polls
##    &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;   &lt;int&gt;
##  1 biden            32.1            9         66     108
##  2 sanders          19.4            4         42     110
##  3 harris            8.62           2         38     110
##  4 warren            8.05           2         43     109
##  5 o_rourke          6.50           2         21     105
##  6 buttigieg         4.88           0         21      80
##  7 booker            3.30           0          9     105
##  8 klobuchar         1.77           0          5      94
##  9 yang              1.13           0          3      62
## 10 castro            1.10           0         12      97
## 11 gillibrand        0.929          0          9      98
## 12 hickenlooper      0.728          0          2      81
## 13 gabbard           0.723          0          3      83
## 14 delaney           0.530          0          8      83
## 15 bullock           0.509          0          1      55
## 16 inslee            0.429          0          2      77</code></pre>
<pre class="r"><code>avg_polls %&gt;% 
  mutate(candidate = fct_reorder(candidate, avg_points)) %&gt;% 
  ggplot(aes(candidate, avg_points)) +
  geom_col() + 
  theme_minimal() +
  coord_flip() +
  labs(title = &quot;Polls Standings&quot;, x = &quot;&quot;, y = &quot;%&quot;)</code></pre>
<p><img src="/post/2019-06-11-scraping-4-campaigns_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>
<div id="creating-historic-polling-data" class="section level2">
<h2>Creating historic polling data</h2>
<p>It may become useful to have a running history of how candidates have been polling. We can use R to write a csv file of the data from FiveThirtyEight. However, what happens when the polls update? How we can we keep the previous data <em>and</em> the new data? We will work through an example using a combination of <code>bind_rows()</code> and <code>distinct()</code>. I want to emphasize that this is not a good practice if you need to scale to hundreds of thousand of rows. This works in this case as the data are inherently small.</p>
<p>To start, I have created a sample dataset which contains 80% of these polls (maybe less by the time you do this!). Note that is probably best to version control this or have multiple copies as a failsafe.</p>
<p>The approach we will take is to read in the historic polls data set and bind rows with the <code>polls_clean</code> data we have scraped. Next we remove duplicate rows using <code>distinct()</code>.</p>
<pre class="r"><code>old_polls &lt;- read_csv(&quot;https://raw.githubusercontent.com/JosiahParry/r-4-campaigns/master/data/polls.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   pollster = col_character(),
##   sample = col_double(),
##   sample_2 = col_character(),
##   candidate = col_character(),
##   points = col_double(),
##   poll_start = col_date(format = &quot;&quot;),
##   poll_end = col_date(format = &quot;&quot;)
## )</code></pre>
<pre class="r"><code>old_polls</code></pre>
<pre><code>## # A tibble: 1,564 x 7
##    pollster       sample sample_2    candidate points poll_start poll_end  
##    &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;    
##  1 C+HarrisX         370 Registered… klobuchar      2 2019-06-06 2019-06-10
##  2 C+HarrisX         448 Registered… gillibra…      1 2019-06-06 2019-06-10
##  3 B-Morning Con…  11627 Likely Vot… harris        13 2019-06-06 2019-06-10
##  4 B-Morning Con…    699 Registered… delaney        0 2019-06-06 2019-06-10
##  5 C+HarrisX         743 Registered… williams…      1 2019-06-06 2019-06-10
##  6 A-Quinnipiac …    559 Registered… gabbard        0 2019-06-06 2019-06-10
##  7 B-Morning Con…  14250 Likely Vot… gillibra…      2 2019-06-06 2019-06-10
##  8 A-Quinnipiac …    559 Registered… gillibra…      0 2019-06-06 2019-06-10
##  9 B-Morning Con…  14250 Likely Vot… harris         6 2019-06-06 2019-06-10
## 10 A+Monmouth Un…    330 Registered… warren         8 2019-06-06 2019-06-10
## # … with 1,554 more rows</code></pre>
<pre class="r"><code>updated_polls &lt;- bind_rows(old_polls, polls_clean) %&gt;% 
  distinct()

updated_polls</code></pre>
<pre><code>## # A tibble: 1,955 x 7
##    pollster       sample sample_2    candidate points poll_start poll_end  
##    &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;    
##  1 C+HarrisX         370 Registered… klobuchar      2 2019-06-06 2019-06-10
##  2 C+HarrisX         448 Registered… gillibra…      1 2019-06-06 2019-06-10
##  3 B-Morning Con…  11627 Likely Vot… harris        13 2019-06-06 2019-06-10
##  4 B-Morning Con…    699 Registered… delaney        0 2019-06-06 2019-06-10
##  5 C+HarrisX         743 Registered… williams…      1 2019-06-06 2019-06-10
##  6 A-Quinnipiac …    559 Registered… gabbard        0 2019-06-06 2019-06-10
##  7 B-Morning Con…  14250 Likely Vot… gillibra…      2 2019-06-06 2019-06-10
##  8 A-Quinnipiac …    559 Registered… gillibra…      0 2019-06-06 2019-06-10
##  9 B-Morning Con…  14250 Likely Vot… harris         6 2019-06-06 2019-06-10
## 10 A+Monmouth Un…    330 Registered… warren         8 2019-06-06 2019-06-10
## # … with 1,945 more rows</code></pre>
<p>Now you have a cleaned data set which has been integrated with the recently scraped data. Write this to a csv using <code>write_csv()</code> for later use.</p>
</div>
</div>

        </p>
    </div>
    
    

    

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="/tags/r">#R</a>
        
            <a class="tag" href="/tags/tutorial">#tutorial</a>
        
            <a class="tag" href="/tags/politics">#politics</a>
        
            <a class="tag" href="/tags/youthvote">#youthvote</a>
        
            <a class="tag" href="/tags/campaigns">#campaigns</a>
        
      
    </div>
    



        




<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    
    <a class="social-icon" href="https://twitter.com/@josiahparry" target="_blank" rel="noopener" title="Twitter">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M8.991284,24.971612 C19.180436,24.971612 24.752372,16.530224 24.752372,9.210524 C24.752372,8.970656 24.747512,8.731868 24.736496,8.494376 C25.818008,7.712564 26.758256,6.737 27.5,5.62622 C26.507372,6.067076 25.439252,6.364292 24.318752,6.498212 C25.462472,5.812628 26.340512,4.727444 26.754584,3.434036 C25.684088,4.068536 24.499004,4.53002 23.23724,4.778528 C22.226468,3.701876 20.786828,3.028388 19.193828,3.028388 C16.134404,3.028388 13.653536,5.509256 13.653536,8.567492 C13.653536,9.0023 13.702244,9.424904 13.797176,9.830552 C9.19346,9.599108 5.11106,7.39472 2.3792,4.04294 C1.903028,4.861364 1.629032,5.812628 1.629032,6.827072 C1.629032,8.74904 2.606972,10.445612 4.094024,11.438132 C3.185528,11.41016 2.331788,11.160464 1.585184,10.745096 C1.583888,10.768208 1.583888,10.791428 1.583888,10.815728 C1.583888,13.49888 3.493652,15.738584 6.028088,16.246508 C5.562932,16.373084 5.07326,16.44134 4.56782,16.44134 C4.210988,16.44134 3.863876,16.406024 3.526484,16.34144 C4.231724,18.542264 6.276596,20.143796 8.701412,20.18894 C6.805148,21.674696 4.416836,22.56008 1.821488,22.56008 C1.374476,22.56008 0.93362,22.534592 0.5,22.4834 C2.951708,24.054476 5.862524,24.971612 8.991284,24.971612"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://linkedin.com/in/josiahparry" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    
    <a class="social-icon" href="https://medium.com/@JosiahParry/" target="_blank" rel="noopener" title="Medium">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,2 L26,2 L26,26 L2,26 L2,2 Z M7.72727142,10.0265545 L7.72727142,17.1527156 C7.77112416,17.4097828 7.69008764,17.6723786 7.50898513,17.8600642 L5.81538462,19.9143852 L5.81538462,20.1852847 L10.617683,20.1852847 L10.617683,19.9143852 L8.92408245,17.8600642 C8.74165168,17.6726892 8.65559727,17.4118239 8.69074193,17.1527156 L8.69074193,10.9897526 L12.9059255,20.1852847 L13.3951878,20.1852847 L17.0157294,10.9897526 L17.0157294,18.3190884 C17.0157294,18.514738 17.0157294,18.5523628 16.8877685,18.6802876 L15.5855778,19.9444852 L15.5855778,20.2153846 L21.9083531,20.2153846 L21.9083531,19.9444852 L20.6513252,18.7103876 C20.5403599,18.6258033 20.4853154,18.4867833 20.50831,18.3491883 L20.50831,9.28158097 C20.4853154,9.14398599 20.5403599,9.00496587 20.6513252,8.92038167 L21.9384615,7.68628409 L21.9384615,7.41538462 L17.4824105,7.41538462 L14.3059685,15.3391941 L10.6929541,7.41538462 L6.01861668,7.41538462 L6.01861668,7.68628409 L7.52403936,9.49980554 C7.67182769,9.63301305 7.74730311,9.82863473 7.72727142,10.0265545 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/josiahparry" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    
</div>




	<div class="footer-mobile-links">
		<p><a href="https://github.com/kimcc/hugo-theme-noteworthy" target="_blank" rel="noopener">Noteworthy theme</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="/js/main.min.c1aee25a817e9beb1f9c4afd9d62311227a7f5e46720e404dc1dda97281f47f2.js" integrity="sha256-wa7iWoF+m+sfnEr9nWIxEien9eRnIOQE3B3alygfR/I="></script>
</footer>
    </body>
</html>